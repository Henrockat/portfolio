<!DOCTYPE html>
<html lang="nl-BE">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Trein Overweg Slagboom - Portfolio</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body class="container py-4">

  <a href="portfolio.html" class="btn btn-outline-secondary mb-4">&larr; Terug naar portfolio</a>

  <h1 class="mb-3">Trein Overweg Slagboom</h1>
  <p class="lead">Trein overweg slagboom met aan/af meld knop. Slagboom werkt met vertraging zodat kruispunt vrij en veilig is voordat slagboom sluit.</p>

  <hr class="my-4">

  <div class="row g-4 align-items-start mb-5">
    <div class="col-lg-6">
      <h2>Mogelijkheid tot simulatie</h2>
      <p>
        Wil je dit project eerst uittesten zonder fysieke hardware? Dat kan! 
        Gebruik de online simulator <a href="https://wokwi.com/" target="_blank" class="text-decoration-underline">Wokwi</a> 
        om je Arduino-code virtueel uit te voeren. Je kunt hier componenten zoals LEDs, knoppen en servo’s eenvoudig slepen en verbinden. 
        Een ideale manier om je project veilig te testen!
      </p>
      <h2>Benodigde hardware</h2>
      <ul>
        <li>1x Arduino Nano</li>
        <li>1x Servo motor (voor slagboom)</li>
        <li>2x Drukknop</li>
        <li>3x LED (2x rood, 1x oranje)</li>
        <li>3x Weerstand (220Ω)</li>
        <li>Breadboard</li>
        <li>Jumper wires</li>
        <li>USB-kabel</li>
      </ul>

      <h2>Stappenplan / Tutorial</h2>
      <ol>
        <li>Plaats de LEDs en drukknoppen op het breadboard. Gebruik 220Ω weerstanden in serie met de LEDs.</li>
        <li>Verbind de knoppen met digitale pinnen en configureer ze met een pull-down of pull-up configuratie.</li>
        <li>Verbind de servo met een PWM-pin op de Arduino.</li>
        <li>Upload de Arduino-code en observeer hoe de slagboom automatisch werkt bij een simulatie van een naderende trein.</li>
      </ol>

    </div>

    <div class="col-lg-6">
      <h2>Schematische weergave</h2>
      <img src="assets/images-labo/Slagboom en signalisatie.PNG" alt="Schema Slagboom" class="img-fluid rounded">
    </div>
  </div>

  <h2>Arduino Code</h2>
  <div class="container">
    <pre><code>
#include <Arduino.h>			

#include <Servo.h>

int LEDr1 = 12;
int LEDr2 = 11;
int LEDy = 8;
int Button_status =0; 		//Detecteren van de aankomst  en vertrek van de trein d.m.v. één drukknop
int Button_status_2=0;		//Status van drukknop 2(vertrek_trein)
int Servo_pin = 9;				// Toewijzen van servor pin

Servo Slagboom;

boolean Slagboom_open = true;

long startTime = 0;              
unsigned long currentTime = millis();
unsigned long elapsedTime;

void Druk_op_knop ()
{	//Interrupt functie om stand van drukknop in te lezen en togellen. 
	
	Button_status = 1;
	Serial.println("Interrupt");
	Serial.println(Button_status);
	// afhankelijk van state van 
	//drukknop 1= slagboom_open onwaar
	//drukknop 0= slagboom_open waar  deze om while loop halt te roepen na het oproepen van de 2 fucnties.
	if (Button_status == 1){
		Slagboom_open = false;
	} else if (Button_status == 0){
		Slagboom_open = true;}
	
}

void Druk_op_knop_2()
{	//Interrupt functie om stand van drukknop in te lezen en togellen. 
	
	Button_status = 0;
	Serial.println("Interrupt2");
	Serial.println(Button_status);
	// afhankelijk van state van 
	//drukknop 1= slagboom_open onwaar
	//drukknop 0= slagboom_open waar  deze om while loop halt te roepen na het oproepen van de 2 fucnties.
	if (Button_status == 0){
		Slagboom_open = true;
	} else if (Button_status == 1){
		Slagboom_open = false;}
}


void setup()
{
  Serial.begin(9600);
	pinMode(LEDr1, OUTPUT);
	pinMode(LEDr2, OUTPUT);
	pinMode(LEDy, OUTPUT);
	Button_status;
	Slagboom.attach(Servo_pin);
  attachInterrupt(0, Druk_op_knop, FALLING);
	attachInterrupt(1, Druk_op_knop_2, FALLING);
}

void loop()
{ //hier worden de functies Naaar_boven en Naar_beneden opgeroepn.
	//

  Serial.println("Button_status");   
	Serial.println(Button_status);
  if (Button_status == 0){	
		Serial.println(" - SlagBoom naar Boven");
    Naar_boven();
    
	} else if (Button_status == 1){
		Serial.println(" - SlagBoom naar Beneden ");
   	Naar_beneden();
    
  }
}

void Naar_beneden (){
Slagboom_open = false;
startTime = millis(); 
	digitalWrite(LEDy, LOW);		
	digitalWrite(LEDr1, HIGH);  
	digitalWrite(LEDr2, LOW);
	
	
while (!Slagboom_open) {
	digitalWrite(LEDr1, (digitalRead(LEDr1))^1);
	digitalWrite(LEDr2, (digitalRead(LEDr2))^1);
	Serial.println(Button_status);
	delay(1000);
	currentTime = millis();									//
	elapsedTime = currentTime-startTime;
	if (elapsedTime> 2999 && elapsedTime<3015) {
		Serial.println(elapsedTime);
    Slagboom.write(0);
    }else{
     Serial.println("not working");
		 Serial.println(elapsedTime);
    }
	}

}

void Naar_boven (){
Slagboom_open = true;  // slagboom_open moet hier true zijn om while loop hieronder te laten werken.
Slagboom.write(90);
digitalWrite(LEDr1, LOW);   // ledr1 ze moet uit samen met ledr2 ander blijft er mischien een van de red leds aan. 
digitalWrite(LEDr2, LOW);
while (Slagboom_open) {
	digitalWrite(LEDy, (digitalRead(LEDy))^1);
	Serial.println(Button_status);
  delay(1000);	
  }
}
    </code></pre>
  </div>

</body>
</html>
